"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[524],{7511:(e,t,n)=>{n(2675),n(9463),n(2259),n(6280),n(6918),n(8706),n(1629),n(3418),n(4346),n(3792),n(2062),n(4114),n(4782),n(739),n(3288),n(2010),n(3110),n(6099),n(3362),n(7495),n(906),n(8781),n(7764),n(1392),n(2762),n(8992),n(3949),n(3500),n(2953);var r=n(7363),o=n(2263),a=n(8680);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("calendar"),t=new bootstrap.Modal(document.getElementById("eventModal")),n=document.getElementById("eventForm");if(e&&!e.dataset.initialized){console.log("✅ Initialisation du calendrier"),e.dataset.initialized="true";var l=new r.Vv(e,{plugins:[o.A,a.Ay],initialView:"dayGridMonth",selectable:!0,editable:!0,headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay"},locale:"fr",buttonText:{today:"Aujourd'hui",month:"Mois",week:"Semaine",day:"Jour",list:"Liste"},events:"/api/events",dateClick:function(e){console.log("📅 Date cliquée :",e.dateStr),n.dataset.selectedDate=e.dateStr,t.show()}});l.render(),n.addEventListener("submit",(function(e){e.preventDefault();var r=document.getElementById("eventTitre").value.trim(),o=document.getElementById("eventStart").value,a=document.getElementById("eventEnd").value,i=n.dataset.selectedDate;if(r&&o&&a){var c="".concat(i,"T").concat(o,":00"),s="".concat(i,"T").concat(a,":00");fetch("/api/add-event",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({titre:r,start:c,end:s})}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw new Error(e.error)}))})).then((function(e){l.addEvent({id:e.id,title:r,start:c,end:s}),alert("✅ Événement ajouté !"),t.hide(),n.reset()})).catch((function(e){return console.error("❌ Erreur:",e)}))}else alert("❌ Remplissez tous les champs !")}));var c=document.getElementById("addCalendarBtn"),s=document.getElementById("calendarUrlInput"),d=document.getElementById("validateCalendarBtn");c.addEventListener("click",(function(){s.style.display="inline",d.style.display="inline"})),d.addEventListener("click",(function(){var e=s.value;console.log("Validation du calendrier avec l'URL:",e),e?(fetch("/proxy.php?url=".concat(encodeURIComponent(e))).then((function(e){return e.text()})).then((function(e){console.log("Données ICS récupérées:",e);var t=function(e){var t=[],n=e.split("\n"),r=null;return n.forEach((function(e){if(e.startsWith("BEGIN:VEVENT"))r={};else if(e.startsWith("END:VEVENT"))t.push(r),r=null;else if(r){var n=i(e.split(":"),2),o=n[0],a=n[1];o&&a&&(r[o]=a.trim())}})),t.map((function(e){return{title:e.SUMMARY,start:e.DTSTART,end:e.DTEND}}))}(e);console.log("Événements analysés:",t),t.forEach((function(e){console.log("Ajout de l'événement:",e),l.addEvent(e)})),fetch("/api/add-ics-events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({events:t})}).then((function(e){return e.ok?e.json():e.json().then((function(e){throw new Error(e.error)}))})).then((function(e){console.log(e.status)})).catch((function(e){return console.error("❌ Erreur lors de l'enregistrement des événements ICS:",e)}))})).catch((function(e){return console.error("Erreur lors de la récupération du fichier ICS:",e)})),s.style.display="none",d.style.display="none"):console.warn("Aucune URL ICS fournie.")}))}})),console.log("This log comes from assets/app.js - welcome to AssetMapper! 🎉")}},e=>{e.O(0,[597],(()=>{return t=7511,e(e.s=t);var t}));e.O()}]);